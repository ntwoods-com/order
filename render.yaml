services:
  # Backend API Service (Flask)
  - type: web
    name: sale-order-backend
    env: python
    plan: free
    healthCheckPath: /api/v1/health
    buildCommand: pip install -r requirements.txt
    startCommand: gunicorn -w 2 -k gthread -t 120 --access-logfile - --error-logfile - -b 0.0.0.0:$PORT wsgi:application
    autoDeploy: true
    envVars:
      - key: APP_ENV
        value: production
      - key: SESSION_COOKIE_SECURE
        value: "1"
      # Set these in Render dashboard (do not commit real values):
      # - SECRET_KEY
      # - JWT_SECRET (optional, can be same as SECRET_KEY)
      # - USER1 / USER2 ... (username:bcrypt_hash)
      # - ADMIN_USERS=admin,user2
      # - DATABASE_URL (Supabase Postgres connection string)
      # Optional:
      # - CORS_ALLOWED_ORIGINS=https://<frontend-url>
      # - JWT_EXPIRES_SECONDS=28800
      # - DB_SSLMODE=require
      # - LOG_FILE=/var/log/app.log

  # Frontend Service (React + Material-UI)
  - type: web
    name: sale-order-frontend
    env: node
    plan: free
    rootDir: frontend
    buildCommand: npm install && npm run build
    startCommand: npm run preview
    autoDeploy: true
    envVars:
      - key: NODE_ENV
        value: production
      # Set this to your backend API URL in Render dashboard:
      # - key: VITE_API_URL
      #   value: https://sale-order-backend.onrender.com
